from items.models import Item
import pandas as pd
from tqdm import tqdm


def run():
    items = Item.objects.filter(images__isnull=False)
    facebook_catalog = []
    for item in tqdm(items):
        row = {
            "id": item.id,
            "title": item.name,
            "description": f"${item.price_display():.2f} - {item.category} - {item.name}",
            "availability": "in stock",
            "condition": "new",
            "price": f"{item.price_display():.2f} MXN",
            "link": f"https://muuch-maaya.com/catalogo/{item.id}",
            "image_link": f"https://rama-media.s3.us-east-2.amazonaws.com/casa-maya{item.images.first().image_path.url}",
            "brand": "Casa Maya",
            "availability_circle_origin.latitude": "19.3672716,",
            "availability_circle_origin.longitude": "-99.1035623",
            "availability_circle_radius": "15",
            "availability_circle_country": "MX",
            "availability_circle_radius_unit": "km",
            "availability_postal_codes": ["03100", "03103", "03104", "03105", "03106", "03107", "03108", "03109", "03110", "03120", "03130", "03140", "03150", "03160", "03170", "03179", "03180", "03189", "03190", "03195", "03200", "03210", "03220", "03230", "03240", "03250", "03260", "03270", "03279", "03280", "03300", "03303", "03310", "03320", "03330", "03340", "03350", "03360", "03370", "03379", "03380", "03389", "03390", "03399", "03400", "03410", "03420", "03430", "03440", "03450", "03460", "03470", "03480", "03489", "03490", "03499", "03500", "03510", "03520", "03530", "03540", "03550", "03560", "03570", "03580", "03589", "03590", "03599", "03600", "03610", "03620", "03630", "03640", "03650", "03659", "03660", "03670", "03680", "03690", "03699", "03700", "03710", "03720", "03730", "03740", "03750", "03760", "03770", "03780", "03790", "03800", "03810", "03820", "03830", "03840", "03849", "03850", "03860", "03870", "03880", "03899", "03900", "03910", "03920", "03930", "03940", "03950", "03960", "03970", "03980", "03990", "04000", "04010", "04020", "04030", "04040", "04050", "04060", "04070", "04080", "04089", "04090", "04099", "04100", "04110", "04120", "04129", "04130", "04140", "04150", "04160", "04170", "04180", "04190", "04200", "04209", "04210", "04220", "04229", "04230", "04240", "04249", "04250", "04259", "04260", "04269", "04270", "04279", "04280", "04289", "04290", "04299", "04300", "04310", "04318", "04319", "04320", "04330", "04339", "04340", "04349", "04350", "04358", "04359", "04360", "04370", "04378", "04379", "04380", "04390", "04398", "04399", "04400", "04410", "04420", "04430", "04440", "04450", "04460", "04470", "04480", "04489", "04490", "04499", "04500", "04510", "04520", "04530", "04540", "04550", "04560", "04570", "04578", "04579", "04580", "04590", "04598", "04599", "04600", "04608", "04609", "04610", "04620", "04630", "04640", "04650", "04660", "04668", "04669", "04670", "04680", "04688", "04689", "04690", "04698", "04699", "04700", "04710", "04720", "04730", "04740", "04750", "04760", "04770", "04780", "04789", "04790", "04799", "04800", "04810", "04820", "04830", "04840", "04849", "04850", "04860", "04870", "04879", "04880", "04889", "04890", "04899", "04900", "04909", "04910", "04920", "04930", "04939", "04940", "04949", "04950", "04959", "04960", "04969", "04970", "04979", "04980", "04989", "04990", "04999", "05000", "05010", "05020", "05030", "05040", "05050", "05060", "05070", "05080", "05089", "05090", "05099", "05100", "05110", "05120", "05129", "05130", "05140", "05149", "05150", "05159", "05160", "05169", "05170", "05179", "05180", "05189", "05190", "05199", "05200", "05208", "05209", "05210", "05219", "05220", "05230", "05240", "05250", "05260", "05270", "05279", "05280", "05289", "05290", "05299", "05300", "05309", "05310", "05319", "05320", "05330", "05340", "05348", "05349", "05350", "05358", "05359", "05360", "05368", "05369", "05370", "05378", "05379", "05380", "05388", "05389", "05390", "05398", "05399", "05400", "05410", "05420", "05430", "05440", "05450", "05460", "05470", "05480", "05490", "05500", "05510", "05520", "05530", "05540", "05550", "05560", "05570", "05580", "05589", "05590", "05599", "05600", "05610", "05620", "05630", "05640", "05650", "05660", "05670", "05680", "05690", "05700", "05710", "05720", "05730", "05740", "05750", "05760", "05770", "05780", "05790", "05800", "05810", "05820"]
        }
        facebook_catalog.append(row)
    df = pd.DataFrame(facebook_catalog)
    df.to_excel("facebook_catalog.xlsx", index=False)
    print("Done")